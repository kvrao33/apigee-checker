{
  "flows": [
    {
      "endpoint": "ProxyEndpoint",
      "flow": "PreFlow",
      "direction": "Request",
      "conditions": [
        {
          "description": "At least one of the authentication policies should be present",
          "anyOf": [
            { "name": "AccessControl", "type": "Policy" },
            { "name": "BasicAuthentication", "type": "Policy" },
            { "name": "HMAC", "type": "Policy" },
            { "name": "OAuthJWTTokenVerification", "type": "Policy" },
            { "name": "OAuth", "type": "Policy" },
            { "name": "ValidateSAMLAssertion", "type": "Policy" },
            { "name": "VerifyAPIKey", "type": "Policy" },
            { "name": "VerifyJWS", "type": "Policy" },
            { "name": "VerifyJWT", "type": "Policy" },
            { "name": "OAuthV2", "type": "Policy" }
          ]
        },
        {
          "description": "any of these policies must be present for rate limiting",
          "anyOf": [
            { "name": "SpikeArrest", "type": "Policy" },
            { "name": "Quota", "type": "Policy" },
            { "name": "LookupCache", "type": "Policy" },
            { "name": "ResponseCache", "type": "Policy" }
          ]
        },
        {
          "description":"Checks whether a mediation policy is enabled in the PreFlow",
          "anyOf":[
            { "name": "JSONThreatProtection", "type": "Policy" },
            { "name": "XMLThreatProtection", "type": "Policy" }]
        },
        {
          "description": "Checks to see if threat prevention policies are used.",
          "anyOf": [
            { "name": "JSONThreatProtection", "type": "Policy" },
            { "name": "XMLThreatProtection", "type": "Policy" },
            { "name":"RegularExpressionProtection", "type": "Policy" }
          ]
        }
      ]
    }
  ]
}
